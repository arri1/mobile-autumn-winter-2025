import { StatusBar } from 'expo-status-bar';
import { Text, TextInput, Switch } from 'react-native';
import styled from 'styled-components/native';
import { useStore } from '../../store/useStore';

export default function ZustandLabScreen() {
  const { count, name, theme, enabled, inputValue, increment, decrement, reset, setName, toggleTheme, setEnabled, setInputValue } = useStore();

  return (
    <SafeArea>
      <Container>
        <Header>
          <Emoji>üêª</Emoji>
          <Title>Zustand –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è</Title>
          <SubTitle>–ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–µ–∑ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤</SubTitle>
        </Header>

        <Card>
          <CardHeader>
            <CardTitle>–ì–ª–æ–±–∞–ª—å–Ω—ã–π —Å—á–µ—Ç—á–∏–∫</CardTitle>
            <Pill tone={count >= 0 ? 'success' : 'neutral'}>{count >= 0 ? 'positive' : 'negative'}</Pill>
          </CardHeader>
          <Divider />
          <CenterColumn>
            <BigCounterValue>{count}</BigCounterValue>
            <ButtonRow>
              <ActionButton onPress={decrement}>
                <ActionText>‚àí</ActionText>
              </ActionButton>
              <ActionButton variant="reset" onPress={reset}>
                <ActionText>0</ActionText>
              </ActionButton>
              <ActionButton onPress={increment}>
                <ActionText>+</ActionText>
              </ActionButton>
            </ButtonRow>
            <Helper>–≠—Ç–æ—Ç —Å—á–µ—Ç—á–∏–∫ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω —Å useState —ç–∫—Ä–∞–Ω–æ–º</Helper>
          </CenterColumn>
        </Card>

        <Card>
          <CardHeader>
            <CardTitle>–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</CardTitle>
            <Pill tone={name ? 'success' : 'neutral'}>{name ? '–∑–∞–ø–æ–ª–Ω–µ–Ω' : '–ø—É—Å—Ç–æ–π'}</Pill>
          </CardHeader>
          <Divider />
          <Column>
            <Label>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</Label>
            <LargeInput
              value={name}
              onChangeText={setName}
              placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è"
              placeholderTextColor="#889096"
            />
            <WelcomeText>üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {name || '–≥–æ—Å—Ç—å'}!</WelcomeText>
          </Column>
        </Card>

        <Card>
          <CardHeader>
            <CardTitle>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</CardTitle>
          </CardHeader>
          <Divider />
          <SettingsRow>
            <SettingsLabel>–¢–µ–º–Ω–∞—è —Ç–µ–º–∞</SettingsLabel>
            <Switch value={theme === 'dark'} onValueChange={toggleTheme} />
          </SettingsRow>
          <SettingsRow>
            <SettingsLabel>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏</SettingsLabel>
            <Switch value={enabled} onValueChange={setEnabled} />
          </SettingsRow>
          <Helper>–≠—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–ª–∏—è—é—Ç –Ω–∞ –≤—Å–µ —ç–∫—Ä–∞–Ω—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</Helper>
        </Card>

        <Card>
          <CardHeader>
            <CardTitle>–ë—ã—Å—Ç—Ä—ã–µ –∑–∞–º–µ—Ç–∫–∏</CardTitle>
            <Pill tone={inputValue ? 'success' : 'neutral'}>{inputValue ? '–µ—Å—Ç—å —Ç–µ–∫—Å—Ç' : '–ø—É—Å—Ç–æ'}</Pill>
          </CardHeader>
          <Divider />
          <Column>
            <Label>–ó–∞–º–µ—Ç–∫–∞</Label>
            <TextArea
              value={inputValue}
              onChangeText={setInputValue}
              placeholder="–ó–∞–ø–∏—à–∏—Ç–µ —á—Ç–æ-–Ω–∏–±—É–¥—å..."
              placeholderTextColor="#889096"
              multiline
              numberOfLines={3}
            />
            <Helper>–°–∏–º–≤–æ–ª–æ–≤: {inputValue.length}</Helper>
          </Column>
        </Card>

        <Card>
          <CardHeader>
            <CardTitle>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Zustand</CardTitle>
          </CardHeader>
          <Divider />
          <FeatureList>
            <FeatureItem>üöÄ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å ‚Äî —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–∏–≤–∞—é—Ç—Å—è</FeatureItem>
            <FeatureItem>üì¶ –ú–∏–Ω–∏–º—É–º –∫–æ–¥–∞ ‚Äî –Ω–∏–∫–∞–∫–∏—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤</FeatureItem>
            <FeatureItem>üîó –ì–ª–æ–±–∞–ª—å–Ω–æ—Å—Ç—å ‚Äî —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ –≤–µ–∑–¥–µ</FeatureItem>
            <FeatureItem>‚ö° –°–∫–æ—Ä–æ—Å—Ç—å ‚Äî –±—ã—Å—Ç—Ä–µ–µ Redux –∏ Context API</FeatureItem>
          </FeatureList>
        </Card>

        <BottomSpacer />
        <StatusBar style="auto" />
      </Container>
    </SafeArea>
  );
}

const SafeArea = styled.SafeAreaView`
  flex: 1;
  background-color: #0a0c10;
`;

const Container = styled.ScrollView`
  flex: 1;
  padding: 24px;
`;

const Header = styled.View`
  margin-bottom: 16px;
`;

const Emoji = styled(Text)`
  font-size: 28px;
`;

const Title = styled(Text)`
  font-size: 28px;
  font-weight: 700;
  color: #e6e9ef;
  margin-bottom: 6px;
`;

const SubTitle = styled(Text)`
  color: #9aa4b2;
`;

const Card = styled.View`
  background-color: #0c0f14;
  border: 1px solid #1c2230;
  border-radius: 16px;
  padding: 16px;
  margin-bottom: 16px;
`;

const CardHeader = styled.View`
  flex-direction: row;
  justify-content: space-between;
  align-items: center;
`;

const CardTitle = styled(Text)`
  color: #e6e9ef;
  font-weight: 700;
`;

const Pill = styled(Text)`
  color: #b3b8c3;
  background-color: ${(p) => (p.tone === 'success' ? '#0e2f25' : '#151a23')};
  border: 1px solid ${(p) => (p.tone === 'success' ? '#1f7a4a' : '#252a33')};
  padding: 4px 8px;
  border-radius: 999px;
  font-size: 12px;
`;

const Divider = styled.View`
  height: 1px;
  background-color: #1c2230;
  margin: 12px 0;
`;

const Row = styled.View`
  flex-direction: row;
  align-items: center;
  ${(p) => (p.space ? 'justify-content: space-between;' : '')};
`;

const Column = styled.View`
  gap: 8px;
`;

const CenterColumn = styled.View`
  align-items: center;
  gap: 16px;
`;

const BigCounterValue = styled(Text)`
  color: #5eead4;
  font-size: 48px;
  font-weight: 700;
  text-align: center;
`;

const ButtonRow = styled.View`
  flex-direction: row;
  gap: 12px;
`;

const ActionButton = styled.TouchableOpacity`
  background-color: ${(p) => (p.variant === 'reset' ? '#2a2f3a' : '#5eead4')};
  width: 50px;
  height: 50px;
  border-radius: 25px;
  justify-content: center;
  align-items: center;
`;

const ActionText = styled(Text)`
  color: ${(p) => (p.variant === 'reset' ? '#e6e9ef' : '#052925')};
  font-size: 24px;
  font-weight: 700;
`;

const Label = styled(Text)`
  color: #b3b8c3;
  font-size: 14px;
  font-weight: 600;
  margin-bottom: 4px;
`;

const LargeInput = styled(TextInput)`
  background-color: #0f1218;
  border: 2px solid #1c2230;
  border-radius: 16px;
  padding: 16px 18px;
  color: #e6e9ef;
  font-size: 16px;
`;

const WelcomeText = styled(Text)`
  color: #5eead4;
  font-size: 18px;
  font-weight: 600;
  text-align: center;
  margin-top: 8px;
`;

const SettingsRow = styled.View`
  flex-direction: row;
  justify-content: space-between;
  align-items: center;
  padding: 12px 0;
`;

const SettingsLabel = styled(Text)`
  color: #e6e9ef;
  font-size: 16px;
  font-weight: 500;
`;

const TextArea = styled(TextInput)`
  background-color: #0f1218;
  border: 2px solid #1c2230;
  border-radius: 16px;
  padding: 16px 18px;
  color: #e6e9ef;
  font-size: 16px;
  min-height: 80px;
  text-align-vertical: top;
`;

const FeatureList = styled.View`
  gap: 12px;
`;

const FeatureItem = styled(Text)`
  color: #9aa4b2;
  font-size: 14px;
  line-height: 20px;
`;

const Helper = styled(Text)`
  color: #9aa4b2;
  ${(p) => (p.ml12 ? 'margin-left: 12px;' : '')};
`;

const BottomSpacer = styled.View`
  height: 24px;
`;
